# The apps array holds hash tables with information about each app that should be unpinned.
# Each hash tables has the name of the app and a byte array containing the bytes that are added to
# the registry when the app in question is pinned. Finally there is an array containing the indexes
# of bytes in the app byte array that appear to be unique for every computer, but that don't actually
# matter. You can set these bytes to 0, 255 or whatever you want, it doesn't seem to matter.
# In order to get a proper match on the byte array on any computer, the script skips bytes
# at these indexes when looking for the app byte array in the registry key.

$apps = @(
    @{
        "appName" = "Microsoft Edge 20.10240.16384.0"
        "appByteArray" = @(0,200,5,0,0,20,0,31,128,155,212,52,66,69,2,243,77,183,128,56,147,148,52,86,225,178,5,0,0,56,5,65,80,80,83,38,5,8,0,3,0,0,0,0,0,0,0,50,2,0,0,49,83,80,83,85,40,76,159,121,159,57,75,168,208,225,212,45,225,213,243,93,0,0,0,17,0,0,0,0,31,0,0,0,38,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,17,0,0,0,14,0,0,0,0,19,0,0,0,1,0,0,0,21,0,0,0,20,0,0,0,0,31,0,0,0,1,0,0,0,0,0,0,0,145,0,0,0,21,0,0,0,0,31,0,0,0,64,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,50,0,48,0,46,0,49,0,48,0,50,0,52,0,48,0,46,0,49,0,54,0,51,0,56,0,52,0,46,0,48,0,95,0,110,0,101,0,117,0,116,0,114,0,97,0,108,0,95,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,121,0,0,0,5,0,0,0,0,31,0,0,0,52,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,137,0,0,0,15,0,0,0,0,31,0,0,0,60,0,0,0,67,0,58,0,92,0,87,0,105,0,110,0,100,0,111,0,119,0,115,0,92,0,83,0,121,0,115,0,116,0,101,0,109,0,65,0,112,0,112,0,115,0,92,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,0,0,0,0,69,2,0,0,49,83,80,83,77,11,212,134,105,144,60,68,129,154,42,84,9,13,204,236,93,0,0,0,12,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,49,0,53,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,2,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,52,0,52,0,120,0,52,0,52,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,13,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,87,0,105,0,100,0,101,0,51,0,49,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,4,0,0,0,0,19,0,0,0,0,120,215,255,93,0,0,0,19,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,51,0,49,0,48,0,120,0,51,0,49,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,5,0,0,0,0,19,0,0,0,255,255,255,255,17,0,0,0,14,0,0,0,0,19,0,0,0,161,0,0,0,49,0,0,0,11,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,89,0,0,0,20,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,55,0,49,0,120,0,55,0,49,0,46,0,112,0,110,0,103,0,0,0,0,0,0,0,49,0,0,0,49,83,80,83,177,22,109,68,173,141,112,72,167,72,64,46,164,61,120,140,21,0,0,0,100,0,0,0,0,21,0,0,0,17,255,211,255,41,172,209,1,0,0,0,0,77,0,0,0,49,83,80,83,48,241,37,183,239,71,26,16,165,241,2,96,140,158,235,172,49,0,0,0,10,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,0,0,0,0,45,0,0,0,49,83,80,83,179,119,237,13,20,198,108,69,174,91,40,91,56,215,176,27,17,0,0,0,7,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,0,0,0,29,0,239,190,2,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,62,5,0,0);
        "bytesThatDontMatter" = @(1227,1228,1229,1230,1231,1232);
    }
    @{
        "appName" = "Microsoft Edge 25.10586.0.0"
        "appByteArray" = @(0,192,5,0,0,20,0,31,128,155,212,52,66,69,2,243,77,183,128,56,147,148,52,86,225,170,5,0,0,48,5,65,80,80,83,30,5,8,0,3,0,0,0,0,0,0,0,42,2,0,0,49,83,80,83,85,40,76,159,121,159,57,75,168,208,225,212,45,225,213,243,93,0,0,0,17,0,0,0,0,31,0,0,0,38,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,17,0,0,0,14,0,0,0,0,19,0,0,0,1,0,0,0,21,0,0,0,20,0,0,0,0,31,0,0,0,1,0,0,0,0,0,0,0,137,0,0,0,21,0,0,0,0,31,0,0,0,60,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,50,0,53,0,46,0,49,0,48,0,53,0,56,0,54,0,46,0,48,0,46,0,48,0,95,0,110,0,101,0,117,0,116,0,114,0,97,0,108,0,95,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,121,0,0,0,5,0,0,0,0,31,0,0,0,52,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,137,0,0,0,15,0,0,0,0,31,0,0,0,60,0,0,0,67,0,58,0,92,0,87,0,105,0,110,0,100,0,111,0,119,0,115,0,92,0,83,0,121,0,115,0,116,0,101,0,109,0,65,0,112,0,112,0,115,0,92,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,0,0,0,0,69,2,0,0,49,83,80,83,77,11,212,134,105,144,60,68,129,154,42,84,9,13,204,236,93,0,0,0,12,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,49,0,53,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,2,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,52,0,52,0,120,0,52,0,52,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,13,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,87,0,105,0,100,0,101,0,51,0,49,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,4,0,0,0,0,19,0,0,0,0,120,215,255,93,0,0,0,19,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,51,0,49,0,48,0,120,0,51,0,49,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,5,0,0,0,0,19,0,0,0,255,255,255,255,17,0,0,0,14,0,0,0,0,19,0,0,0,161,0,0,0,49,0,0,0,11,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,89,0,0,0,20,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,55,0,49,0,120,0,55,0,49,0,46,0,112,0,110,0,103,0,0,0,0,0,0,0,49,0,0,0,49,83,80,83,177,22,109,68,173,141,112,72,167,72,64,46,164,61,120,140,21,0,0,0,100,0,0,0,0,21,0,0,0,168,170,195,227,109,183,209,1,0,0,0,0,77,0,0,0,49,83,80,83,48,241,37,183,239,71,26,16,165,241,2,96,140,158,235,172,49,0,0,0,10,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,0,0,0,0,45,0,0,0,49,83,80,83,179,119,237,13,20,198,108,69,174,91,40,91,56,215,176,27,17,0,0,0,7,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,0,0,0,29,0,239,190,2,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,54,5,0,0)
        "bytesThatDontMatter" = @(1219,1220,1221,1222,1223,1224);
    }
    @{
        "appName" = "Microsoft Edge 25.10586.0.0"
        "appByteArray" = @(0,52,6,0,0,20,0,31,128,155,212,52,66,69,2,243,77,183,128,56,147,148,52,86,225,30,6,0,0,48,5,65,80,80,83,30,5,8,0,3,0,0,0,0,0,0,0,42,2,0,0,49,83,80,83,85,40,76,159,121,159,57,75,168,208,225,212,45,225,213,243,93,0,0,0,17,0,0,0,0,31,0,0,0,38,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,17,0,0,0,14,0,0,0,0,19,0,0,0,1,0,0,0,21,0,0,0,20,0,0,0,0,31,0,0,0,1,0,0,0,0,0,0,0,137,0,0,0,21,0,0,0,0,31,0,0,0,60,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,50,0,53,0,46,0,49,0,48,0,53,0,56,0,54,0,46,0,48,0,46,0,48,0,95,0,110,0,101,0,117,0,116,0,114,0,97,0,108,0,95,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,121,0,0,0,5,0,0,0,0,31,0,0,0,52,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,137,0,0,0,15,0,0,0,0,31,0,0,0,60,0,0,0,67,0,58,0,92,0,87,0,105,0,110,0,100,0,111,0,119,0,115,0,92,0,83,0,121,0,115,0,116,0,101,0,109,0,65,0,112,0,112,0,115,0,92,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,0,0,0,0,69,2,0,0,49,83,80,83,77,11,212,134,105,144,60,68,129,154,42,84,9,13,204,236,93,0,0,0,12,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,49,0,53,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,2,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,52,0,52,0,120,0,52,0,52,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,13,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,87,0,105,0,100,0,101,0,51,0,49,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,4,0,0,0,0,19,0,0,0,0,120,215,255,93,0,0,0,19,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,51,0,49,0,48,0,120,0,51,0,49,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,5,0,0,0,0,19,0,0,0,255,255,255,255,17,0,0,0,14,0,0,0,0,19,0,0,0,161,0,0,0,49,0,0,0,11,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,89,0,0,0,20,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,55,0,49,0,120,0,55,0,49,0,46,0,112,0,110,0,103,0,0,0,0,0,0,0,49,0,0,0,49,83,80,83,177,22,109,68,173,141,112,72,167,72,64,46,164,61,120,140,21,0,0,0,100,0,0,0,0,21,0,0,0,168,170,195,227,109,183,209,1,0,0,0,0,77,0,0,0,49,83,80,83,48,241,37,183,239,71,26,16,165,241,2,96,140,158,235,172,49,0,0,0,10,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,0,0,0,0,45,0,0,0,49,83,80,83,179,119,237,13,20,198,108,69,174,91,40,91,56,215,176,27,17,0,0,0,7,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,0,0,0,29,0,239,190,2,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,54,5,116,0,0,0,29,0,239,190,2,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,54,5,0,0)
        "bytesThatDontMatter" = @(1219,1220,1221,1222,1223,1224);
    }
    @{
        "appName" = "Microsoft Edge 38.14393.0.0"
        "appByteArray" = @(0,226,5,0,0,20,0,31,128,155,212,52,66,69,2,243,77,183,128,56,147,148,52,86,225,204,5,0,0,48,5,65,80,80,83,30,5,8,0,3,0,0,0,0,0,0,0,42,2,0,0,49,83,80,83,85,40,76,159,121,159,57,75,168,208,225,212,45,225,213,243,93,0,0,0,17,0,0,0,0,31,0,0,0,38,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,17,0,0,0,14,0,0,0,0,19,0,0,0,1,0,0,0,21,0,0,0,20,0,0,0,0,31,0,0,0,1,0,0,0,0,0,0,0,137,0,0,0,21,0,0,0,0,31,0,0,0,60,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,51,0,56,0,46,0,49,0,52,0,51,0,57,0,51,0,46,0,48,0,46,0,48,0,95,0,110,0,101,0,117,0,116,0,114,0,97,0,108,0,95,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,121,0,0,0,5,0,0,0,0,31,0,0,0,52,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,137,0,0,0,15,0,0,0,0,31,0,0,0,60,0,0,0,67,0,58,0,92,0,87,0,105,0,110,0,100,0,111,0,119,0,115,0,92,0,83,0,121,0,115,0,116,0,101,0,109,0,65,0,112,0,112,0,115,0,92,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,0,0,0,0,0,0,69,2,0,0,49,83,80,83,77,11,212,134,105,144,60,68,129,154,42,84,9,13,204,236,93,0,0,0,12,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,49,0,53,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,2,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,52,0,52,0,120,0,52,0,52,0,46,0,112,0,110,0,103,0,0,0,89,0,0,0,13,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,87,0,105,0,100,0,101,0,51,0,49,0,48,0,120,0,49,0,53,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,4,0,0,0,0,19,0,0,0,0,120,215,255,93,0,0,0,19,0,0,0,0,31,0,0,0,38,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,51,0,49,0,48,0,120,0,51,0,49,0,48,0,46,0,112,0,110,0,103,0,0,0,17,0,0,0,5,0,0,0,0,19,0,0,0,255,255,255,255,17,0,0,0,14,0,0,0,0,19,0,0,0,161,0,0,0,49,0,0,0,11,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,89,0,0,0,20,0,0,0,0,31,0,0,0,36,0,0,0,65,0,115,0,115,0,101,0,116,0,115,0,47,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,83,0,113,0,117,0,97,0,114,0,101,0,55,0,49,0,120,0,55,0,49,0,46,0,112,0,110,0,103,0,0,0,0,0,0,0,49,0,0,0,49,83,80,83,177,22,109,68,173,141,112,72,167,72,64,46,164,61,120,140,21,0,0,0,100,0,0,0,0,21,0,0,0,155,79,238,176,102,252,209,1,0,0,0,0,77,0,0,0,49,83,80,83,48,241,37,183,239,71,26,16,165,241,2,96,140,158,235,172,49,0,0,0,10,0,0,0,0,31,0,0,0,15,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,32,0,69,0,100,0,103,0,101,0,0,0,0,0,0,0,0,0,45,0,0,0,49,83,80,83,179,119,237,13,20,198,108,69,174,91,40,91,56,215,176,27,17,0,0,0,7,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,0,0,0,29,0,239,190,2,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,95,0,56,0,119,0,101,0,107,0,121,0,98,0,51,0,100,0,56,0,98,0,98,0,119,0,101,0,33,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,69,0,100,0,103,0,101,0,0,0,54,5,34,0,0,0,30,0,239,190,2,0,85,0,115,0,101,0,114,0,80,0,105,0,110,0,110,0,101,0,100,0,0,0,54,5,0,0)
        "bytesThatDontMatter" = @(1219,1220,1221,1222,1223,1224);
    }
)

# Start with the assumption that no apps are pinned.
$atLeastOneAppIsPinned = $false

foreach ($app in $apps)
{
    # Save the current value of the taskbar registry key as a byte array
    $currentTaskBar = (Get-ItemProperty -Path "hkcu:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband" -Name "Favorites").Favorites

    # Save the last index for our two byte arrays
    $currentTaskBarLastIndex = ($currentTaskBar.Length - 1)
    $appByteArrayLastIndex = ($app["appByteArray"].Length - 1)

    # Used to keep track of the current location in the byte arrays
    $appByteArrayCurrentIndex = 0
    $currentTaskBarCurrentIndex = 0

    # Loop through the registry byte array
    while ($currentTaskBarCurrentIndex -lt $currentTaskBarLastIndex)
    {
        if ($currentTaskBar[$currentTaskBarCurrentIndex] -eq $app["appByteArray"][$appByteArrayCurrentIndex]  -or ($appByteArrayCurrentIndex -in $app["bytesThatDontMatter"]))
        {
            # If the current value of the registry byte array matches the first value of the app byte array,
            # we save the current registry byte array index.
            $startIndex = $currentTaskBarCurrentIndex

            # We then proceed to compare the next item in the registry byte array with the next value in the
            # app byte array until we no longer get a match, like a greedy regex.
            while ($currentTaskBar[$currentTaskBarCurrentIndex] -eq $app["appByteArray"][$appByteArrayCurrentIndex] -or ($appByteArrayCurrentIndex -in $app["bytesThatDontMatter"]))
            {
                $appByteArrayCurrentIndex += 1
                $currentTaskBarCurrentIndex += 1
            }

            # If the last match was the last item in the app byte array, we have located the entire app byte
            # array inside the registry byte array. This means Edge is pinned. Save the indexes in the registry
            # byte array where the Edge byte array begins and ends ($startIndex and $endIndex).
            if (($appByteArrayCurrentIndex - 1) -eq $appByteArrayLastIndex)
            {
                $atLeastOneAppIsPinned = $true

                # Create a new version of the taskbar registry key
                if ($startIndex -ne 0)
                {
                    $firstHalfOfTaskbarWithoutCurrentApp = $currentTaskBar[0..($startIndex - 1)]
                }
                else
                {
                    $firstHalfOfTaskbarWithoutCurrentApp = @()
                }

                $lastHalfOfTaskbarWithoutCurrentApp = $currentTaskBar[($currentTaskBarCurrentIndex)..($currentTaskBar.Length-1)]
                $TaskbarWithoutCurrentApp = $firstHalfOfTaskbarWithoutCurrentApp + $lastHalfOfTaskbarWithoutCurrentApp

                # Overwrite the existing taskbar registry key with the version that has Edge unpinned
                New-ItemProperty -Path "hkcu:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband" -Name "Favorites" -Value $TaskbarWithoutCurrentApp -PropertyType Binary -Force | Out-Null
            }

            # Reset the app byte array index counter
            $appByteArrayCurrentIndex = 0

            # Move the registry byte array index back to the location of the match that caused us to enter this
            # if block.
            $currentTaskBarCurrentIndex = $startIndex
        }

        # Step to the next byte in the registry array
        $currentTaskBarCurrentIndex += 1
    }
}

if ($atLeastOneAppIsPinned)
{
    # Write-Output "At least one app is pinned, unpinning and restarting explorer.exe to refresh taskbar."

    # Restart Explorer to refresh the taskbar
    Invoke-Expression "taskkill /f /im explorer.exe"
    Invoke-Expression "start explorer.exe"
}
else
{
    Write-Output "No apps are pinned."
}